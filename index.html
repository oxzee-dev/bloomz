<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MINI BLOOMBERG TERMINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        bloomberg: {
                            orange: "#e65c00",          // slightly desaturated
                            black: "#000000",
                            dark: "#0f0f0f",
                            gray: "#1f2937",
                            "light-gray": "#9ca3af",
                            green: "#10b981",
                            red: "#ef4444",
                            yellow: "#facc15",
                            blue: "#3b82f6",
                            cyan: "#06b6d4",
                        },
                    },
                    fontFamily: {
                        terminal: ['"Courier New"', 'Monaco', 'Consolas', 'monospace'],
                    },
                    animation: {
                        "ticker": "ticker 50s linear infinite",
                        "blink": "blink 1.4s step-end infinite",
                        "fade-in": "fadeIn 0.4s ease-out",
                    },
                    keyframes: {
                        ticker: { "0%": { transform: "translateX(0)" }, "100%": { transform: "translateX(-50%)" } },
                        blink: { "0%, 50%": { opacity: "1" }, "51%, 100%": { opacity: "0" } },
                        fadeIn: { from: { opacity: "0", transform: "translateY(8px)" }, to: { opacity: "1", transform: "translateY(0)" } },
                    },
                },
            },
        }
    </script>
    <style>
        :root {
            --bg: #000000;
            --text: #d1d5db;
            --text-dim: #9ca3af;
            --card: #111111;
            --border: #1f2937;
            --accent: #e65c00;
        }
        body {
            font-family: "Courier New", Monaco, Consolas, monospace;
            background-color: var(--bg);
            color: var(--text);
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .scanline {
            position: fixed; inset: 0; pointer-events: none; z-index: 9999; opacity: 0.07;
            background: linear-gradient(to bottom, rgba(255,255,255,0.03) 0%, transparent 50%, rgba(0,0,0,0.4) 50%, rgba(0,0,0,0.4));
            background-size: 100% 3px;
        }
        .ticker-tape {
            background: #0a0a0a;
            border-bottom: 1px solid var(--border);
            overflow: hidden;
            white-space: nowrap;
        }
        .ticker-item {
            padding: 10px 24px;
            border-right: 1px solid var(--border);
        }
        .ticker-item:hover { background: #111; }
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            scroll-behavior: smooth;
        }
        .chat-message {
            margin-bottom: 28px;
            border-left: 2px solid #4b5563;
            padding-left: 16px;
            animation: fade-in 0.4s ease-out;
        }
        .command-line {
            color: var(--text-dim);
            font-size: 13px;
            margin-bottom: 8px;
        }
        .input-area {
            border-top: 1px solid var(--border);
            background: #0a0a0a;
            padding: 16px 24px;
        }
        .command-input {
            background: #0f0f0f;
            border: 1px solid var(--border);
            color: #fbbf24;
            width: 100%;
            padding: 12px 16px;
            font-size: 15px;
            font-weight: normal;
        }
        .command-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(230,92,0,0.15);
        }
        .panel, .metric-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 6px;
        }
        .metric-card:hover {
            border-color: #4b5563;
        }
        .news-item {
            padding: 16px;
            border-left: 3px solid transparent;
            transition: all 0.15s;
        }
        .news-item:hover {
            background: #171717;
            border-left-color: #6b7280;
        }
        .value-up { color: #10b981; }
        .value-down { color: #ef4444; }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #374151; }
        ::-webkit-scrollbar-thumb:hover { background: #e65c00; }
    </style>
</head>
<body>
    <div class="scanline"></div>

    <!-- Ticker Tape -->
    <div class="ticker-tape">
        <div class="ticker-content inline-flex" id="tickerTape"></div>
    </div>

    <!-- Header -->
    <header class="border-b border-gray-800 bg-black p-3 flex justify-between items-center shrink-0">
        <div class="flex items-center gap-5">
            <div class="flex items-center gap-3">
                <i class="fas fa-terminal text-[#e65c00] text-xl"></i>
                <span class="text-[#e65c00] font-medium tracking-wide">MINI BLOOMBERG</span>
                <span class="text-xs border border-gray-700 px-2 py-0.5 rounded text-gray-400">PRO</span>
            </div>
            <div class="h-4 w-px bg-gray-800"></div>
            <div class="flex items-center gap-2 text-sm">
                <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                <span class="text-emerald-400">MARKET OPEN</span>
            </div>
        </div>
        <div class="flex items-center gap-5 text-sm font-mono text-gray-300">
            <div class="flex items-center gap-2">
                <i class="fas fa-clock text-[#e65c00]"></i>
                <span id="clock">00:00:00</span>
            </div>
        </div>
    </header>

    <!-- Chat Area -->
    <div id="chatContainer" class="chat-container">
        <div id="welcomeMessage" class="text-center p-12 opacity-70">
            <pre class="text-[#e65c00] mb-6 text-sm leading-tight font-mono">
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘             MINI BLOOMBERG TERMINAL                  â•‘
â•‘                                                            â•‘
â•‘  WEI  GP  TOP  ECO  SECF  DES [TICKER]  FA [TICKER]  â•‘
â•‘                 ETF          HELP                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            </pre>
            <div class="text-gray-400">Enter command below</div>
        </div>
        <div id="chatHistory"></div>
        <div id="loadingIndicator" class="hidden p-6 text-center">
            <span class="loading mr-3"></span>
            <span class="text-[#e65c00] animate-blink">PROCESSING</span>
        </div>
    </div>

    <!-- Input -->
    <div class="input-area">
        <div class="relative">
            <div class="flex items-center gap-4">
                <span class="text-[#e65c00] text-xl animate-blink">â†’</span>
                <input type="text" id="commandInput" class="command-input" placeholder="ENTER COMMAND..." autocomplete="off" spellcheck="false">
                <button onclick="clearChat()" class="px-4 py-2 text-sm border border-gray-700 rounded hover:border-[#e65c00] hover:text-[#e65c00] transition-colors">
                    CLEAR
                </button>
            </div>
            <div id="autocompleteDropdown" class="absolute bottom-full left-0 right-0 bg-[#0f0f0f] border border-[#e65c00]/30 rounded mt-1 max-h-64 overflow-y-auto hidden z-50"></div>
        </div>

        <div class="quick-buttons flex gap-2 mt-4 overflow-x-auto pb-2">
            <button onclick="executeQuickCommand('WEI')" class="quick-btn">WEI</button>
            <button onclick="executeQuickCommand('GP')" class="quick-btn">GP</button>
            <button onclick="executeQuickCommand('TOP')" class="quick-btn">TOP</button>
            <button onclick="executeQuickCommand('SECF')" class="quick-btn">SECF</button>
            <button onclick="executeQuickCommand('ETF')" class="quick-btn">ETF</button>
            <button onclick="executeQuickCommand('DES AAPL')" class="quick-btn">DES AAPL</button>
            <button onclick="executeQuickCommand('FA AAPL')" class="quick-btn">FA AAPL</button>
            <button onclick="executeQuickCommand('HELP')" class="quick-btn">HELP</button>
        </div>
    </div>

    <script>
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Clock & Ticker (unchanged logic, only style tweaks)
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function updateClock() {
            document.getElementById('clock').textContent = new Date().toLocaleTimeString('en-US', {hour12: false});
        }
        setInterval(updateClock, 1000); updateClock();

        const TICKER_SYMBOLS = [
            { symbol: '^GSPC', name: 'S&P 500', flag: 'ğŸ‡ºğŸ‡¸' },
            { symbol: '^NDX', name: 'NASDAQ 100', flag: 'ğŸ‡ºğŸ‡¸' },
            { symbol: '^DJI', name: 'DOW JONES', flag: 'ğŸ‡ºğŸ‡¸' },
            { symbol: '^VIX', name: 'VIX', flag: 'ğŸ‡ºğŸ‡¸' },
            { symbol: '^FTSE', name: 'FTSE 100', flag: 'ğŸ‡¬ğŸ‡§' },
            { symbol: '^N225', name: 'NIKKEI 225', flag: 'ğŸ‡¯ğŸ‡µ' },
            { symbol: 'EURUSD=X', name: 'EUR/USD', flag: 'ğŸ‡ªğŸ‡º' },
            { symbol: 'GC=F', name: 'GOLD', flag: 'Gold' },
            { symbol: 'CL=F', name: 'CRUDE OIL', flag: 'Oil' },
            { symbol: 'BTC-USD', name: 'BITCOIN', flag: 'â‚¿' }
        ];

        async function initTicker() { /* same as before */ }
        async function updateTickerData() { /* same as before */ }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // Core chat & command logic (minimal changes)
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const commandInput = document.getElementById('commandInput');
        const chatHistory = document.getElementById('chatHistory');
        const loadingIndicator = document.getElementById('loadingIndicator');

        function addMessage(html, isError = false) {
            document.getElementById('welcomeMessage').style.display = 'none';
            const div = document.createElement('div');
            div.className = 'chat-message';
            const ts = new Date().toLocaleTimeString('en-US', {hour12:false});
            div.innerHTML = `
                <div class="command-line">
                    <span class="text-gray-600">[${ts}]</span>
                    <span class="text-[#e65c00] ml-2">â†’</span>
                    <span class="${isError?'text-red-500':'text-[#fbbf24]'} ml-1">${commandInput.value || 'SYSTEM'}</span>
                </div>
                <div class="mt-1">${html}</div>
            `;
            chatHistory.appendChild(div);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function clearChat() {
            chatHistory.innerHTML = '';
            document.getElementById('welcomeMessage').style.display = 'block';
        }

        // API fetch (unchanged)
        const API_BASE = 'https://mini-finapi.vercel.app/api';
        async function fetchTicker(ticker) {
            try {
                const res = await fetch(`${API_BASE}/ticker?ticker=${encodeURIComponent(ticker)}`);
                if (!res.ok) throw new Error('API error');
                return await res.json();
            } catch (e) {
                console.error(e);
                return {};
            }
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // FA - Financial Analysis (enhanced with more metrics)
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        async function loadFinancialAnalysis(ticker) {
            const data = await fetchTicker(ticker);
            if (!data.main_info) {
                addMessage('<div class="text-red-500 p-4">No data available</div>', true);
                return;
            }

            const ret = data.returns || {};
            const perf = data.price_performance || {};
            const ratios = data.ratios || {};
            const growth = data.growth || {};

            let html = `
<div class="panel p-6">
    <div class="text-lg font-medium text-gray-200 mb-5">FINANCIAL ANALYSIS â€¢ ${ticker.toUpperCase()}</div>

    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8">
        <div class="metric-card p-5">
            <div class="text-xs text-gray-500 uppercase mb-2">Market Cap</div>
            <div class="text-2xl font-medium">${data.main_info.marketCap || 'â€“'}</div>
        </div>
        <div class="metric-card p-5">
            <div class="text-xs text-gray-500 uppercase mb-2">Trailing P/E</div>
            <div class="text-2xl font-medium">${data.main_info.PE?.toFixed(1) || 'â€“'}</div>
        </div>
        <div class="metric-card p-5">
            <div class="text-xs text-gray-500 uppercase mb-2">Forward P/E</div>
            <div class="text-2xl font-medium">${data.main_info.forwardPE?.toFixed(1) || 'â€“'}</div>
        </div>
        <div class="metric-card p-5">
            <div class="text-xs text-gray-500 uppercase mb-2">Beta (5Y)</div>
            <div class="text-2xl font-medium">${ratios.beta?.toFixed(2) || 'â€“'}</div>
        </div>
    </div>

    <div class="grid md:grid-cols-3 gap-5 mb-8">
        <div class="metric-card p-5">
            <div class="text-sm text-gray-400 mb-3">1-Year Total Return</div>
            <div class="text-2xl font-medium ${perf.oneYearChange >= 0 ? 'value-up' : 'value-down'}">
                ${perf.oneYearChange ? perf.oneYearChange.toFixed(1) + '%' : 'â€“'}
            </div>
        </div>
        <div class="metric-card p-5">
            <div class="text-sm text-gray-400 mb-3">3-Year Annualized</div>
            <div class="text-2xl font-medium ${ret.threeYearReturn >= 0 ? 'value-up' : 'value-down'}">
                ${ret.threeYearReturn ? ret.threeYearReturn.toFixed(1) + '%' : 'â€“'}
            </div>
        </div>
        <div class="metric-card p-5">
            <div class="text-sm text-gray-400 mb-3">5-Year Annualized</div>
            <div class="text-2xl font-medium ${ret.fiveYearReturn >= 0 ? 'value-up' : 'value-down'}">
                ${ret.fiveYearReturn ? ret.fiveYearReturn.toFixed(1) + '%' : 'â€“'}
            </div>
        </div>
    </div>

    <div class="grid md:grid-cols-2 gap-6">
        <div class="panel p-5">
            <div class="text-gray-300 font-medium mb-4">Profitability & Efficiency</div>
            <div class="space-y-3 text-sm">
                <div class="flex justify-between"><span class="text-gray-500">Gross Margin</span><span>${ret.grossMargins || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Operating Margin</span><span>${ret.operatingMargins || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Net Margin</span><span>${ret.profitMargins || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">ROE</span><span>${ratios.returnOnEquity || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">ROA</span><span>${ratios.returnOnAssets || 'â€“'}</span></div>
            </div>
        </div>

        <div class="panel p-5">
            <div class="text-gray-300 font-medium mb-4">Growth & Health</div>
            <div class="space-y-3 text-sm">
                <div class="flex justify-between"><span class="text-gray-500">Revenue Growth (YoY)</span><span class="${growth.revenueGrowth?.includes('-')?'value-down':'value-up'}">${growth.revenueGrowth || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">EPS Growth (YoY)</span><span class="${growth.earningsGrowth?.includes('-')?'value-down':'value-up'}">${growth.earningsGrowth || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Debt / Equity</span><span>${ratios.debtToEquity?.toFixed(2) || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Current Ratio</span><span>${ratios.currentRatio?.toFixed(2) || 'â€“'}</span></div>
                <div class="flex justify-between"><span class="text-gray-500">Free Cash Flow</span><span class="text-cyan-400">${data.debt?.freeCashflow || 'â€“'}</span></div>
            </div>
        </div>
    </div>
</div>`;

            addMessage(html);
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        // DES - Improved news layout
        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        async function loadCompanyDescription(ticker) {
            const data = await fetchTicker(ticker);
            if (!data.main_info) return addMessage('<div class="text-red-500">No data</div>', true);

            const info = data.main_info;
            const change = parseFloat(info.oneDayChange || 0);
            const desc = (data.company_business?.longBusinessSummary || '').split(/[\.\!\?]\s+/).slice(0,5).join('. ') + (desc ? '.' : '');

            let newsHtml = '<div class="space-y-4 mt-6">';
            (data.recent_news || []).slice(0,10).forEach(n => {
                const time = new Date(n.pubDate).toLocaleString([], {month:'short', day:'numeric', hour:'2-digit', minute:'2-digit'});
                newsHtml += `
<div class="news-item border-gray-800 hover:border-gray-600 transition-colors cursor-pointer" onclick="window.open('${n.link || '#'}','_blank')">
    <div class="font-medium text-gray-100 mb-1 line-clamp-2">${n.title}</div>
    <div class="text-xs text-gray-500 flex justify-between">
        <span>${n.source || 'â€“'}</span>
        <span>${time}</span>
    </div>
</div>`;
            });
            newsHtml += '</div>';

            const html = `
<div class="panel p-6">
    <div class="flex flex-col md:flex-row justify-between gap-6 mb-6">
        <div>
            <h1 class="text-2xl font-medium text-gray-100">${info.shortName} <span class="text-lg text-gray-500">(${ticker})</span></h1>
            <div class="text-sm text-gray-500 mt-1">${data.company_info?.sector || ''} â€¢ ${data.company_info?.industry || ''}</div>
        </div>
        <div class="text-right">
            <div class="text-3xl font-medium">${info.currentPrice?.toFixed(2) || 'â€“'}</div>
            <div class="text-lg ${change>=0?'value-up':'value-down'}">${change>=0?'+':''}${change.toFixed(2)}%</div>
        </div>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <div class="metric-card p-4 text-center">
            <div class="text-xs text-gray-500 uppercase">Market Cap</div>
            <div class="text-xl font-medium mt-1">${info.marketCap || 'â€“'}</div>
        </div>
        <div class="metric-card p-4 text-center">
            <div class="text-xs text-gray-500 uppercase">Forward P/E</div>
            <div class="text-xl font-medium mt-1">${info.forwardPE?.toFixed(1) || 'â€“'}</div>
        </div>
        <div class="metric-card p-4 text-center">
            <div class="text-xs text-gray-500 uppercase">Analyst Target</div>
            <div class="text-xl font-medium mt-1">$${data.price_targets?.targetMeanPrice?.toFixed(0) || 'â€“'}</div>
        </div>
        <div class="metric-card p-4 text-center">
            <div class="text-xs text-gray-500 uppercase">Recommendation</div>
            <div class="text-xl font-medium mt-1">${data.recommendation?.recommendationKey || 'â€“'}</div>
        </div>
    </div>

    <div class="mb-8">
        <h3 class="text-gray-300 font-medium mb-3">Business Summary</h3>
        <p class="text-gray-400 text-sm leading-relaxed">${desc || 'No description available.'}</p>
    </div>

    <div class="mb-8">
        <h3 class="text-gray-300 font-medium mb-3">Next Earnings</h3>
        <div class="text-gray-300">${data.earnings?.earningsDate?.[0] || 'â€“'}</div>
    </div>

    <div>
        <h3 class="text-gray-300 font-medium mb-4">Recent News</h3>
        ${newsHtml || '<div class="text-gray-500">No recent news</div>'}
    </div>
</div>`;

            addMessage(html);
        }

        // Other commands (WEI, GP, TOP, SECF, ETF, etc.) remain similar to previous version
        // with softer colors, less bold, no emojis except ticker tape

        // For brevity, only FA and DES are fully shown updated above.
        // You can merge the rest from your previous code.

        commandInput.focus();
        initTicker();
    </script>
</body>
</html>
